{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(_ref){let{setUserId,setRole}=_ref;const[nom,setNom]=useState('');const[motDePasse,setMotDePasse]=useState('');const[numeroPolice,setNumeroPolice]=useState('');const[role,setRoleLocal]=useState('client');const[error,setError]=useState('');const navigate=useNavigate();const handleSubmit=async e=>{e.preventDefault();try{let data={nom,mot_de_passe:motDePasse,role};if(role==='client')data.numero_police=numeroPolice;const res=await axios.post('http://localhost:5000/api/auth/login',data);localStorage.setItem('token',res.data.token);setUserId(res.data.userId);setRole(res.data.role);// Redirection selon le rôle\nif(res.data.role==='client')navigate('/mes-sinistres');else if(res.data.role==='gestionnaire'||res.data.role==='administrateur')navigate('/utilisateurs');else if(res.data.role==='expert')navigate('/ajout-rapport-expertise');else if(res.data.role==='reparateur')navigate('/ajout-rapport-reparation');}catch(err){setError('Identifiants incorrects');}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Connexion\"}),/*#__PURE__*/_jsxs(\"select\",{value:role,onChange:e=>setRoleLocal(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"client\",children:\"Client\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gestionnaire\",children:\"Gestionnaire\"}),/*#__PURE__*/_jsx(\"option\",{value:\"administrateur\",children:\"Administrateur\"}),/*#__PURE__*/_jsx(\"option\",{value:\"expert\",children:\"Expert\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reparateur\",children:\"R\\xE9parateur\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nom\",value:nom,onChange:e=>setNom(e.target.value),required:true}),role==='client'&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Num\\xE9ro de police\",value:numeroPolice,onChange:e=>setNumeroPolice(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Mot de passe\",value:motDePasse,onChange:e=>setMotDePasse(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Se connecter\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error})]});}export default Login;","map":{"version":3,"names":["React","useState","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Login","_ref","setUserId","setRole","nom","setNom","motDePasse","setMotDePasse","numeroPolice","setNumeroPolice","role","setRoleLocal","error","setError","navigate","handleSubmit","e","preventDefault","data","mot_de_passe","numero_police","res","post","localStorage","setItem","token","userId","err","onSubmit","className","children","value","onChange","target","type","placeholder","required"],"sources":["C:/Users/NGAHA NGAHA/preventis-Gestion-Sinistre/frontend/src/components/Auth/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nfunction Login({ setUserId, setRole }) {\n  const [nom, setNom] = useState('');\n  const [motDePasse, setMotDePasse] = useState('');\n  const [numeroPolice, setNumeroPolice] = useState('');\n  const [role, setRoleLocal] = useState('client');\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      let data = { nom, mot_de_passe: motDePasse, role };\n      if (role === 'client') data.numero_police = numeroPolice;\n      const res = await axios.post('http://localhost:5000/api/auth/login', data);\n      localStorage.setItem('token', res.data.token);\n      setUserId(res.data.userId);\n      setRole(res.data.role);\n\n      // Redirection selon le rôle\n      if (res.data.role === 'client') navigate('/mes-sinistres');\n      else if (res.data.role === 'gestionnaire' || res.data.role === 'administrateur') navigate('/utilisateurs');\n      else if (res.data.role === 'expert') navigate('/ajout-rapport-expertise');\n      else if (res.data.role === 'reparateur') navigate('/ajout-rapport-reparation');\n    } catch (err) {\n      setError('Identifiants incorrects');\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"form\">\n      <h2>Connexion</h2>\n      <select value={role} onChange={e => setRoleLocal(e.target.value)}>\n        <option value=\"client\">Client</option>\n        <option value=\"gestionnaire\">Gestionnaire</option>\n        <option value=\"administrateur\">Administrateur</option>\n        <option value=\"expert\">Expert</option>\n        <option value=\"reparateur\">Réparateur</option>\n      </select>\n      <input type=\"text\" placeholder=\"Nom\" value={nom} onChange={e => setNom(e.target.value)} required />\n      {role === 'client' && (\n        <input type=\"text\" placeholder=\"Numéro de police\" value={numeroPolice} onChange={e => setNumeroPolice(e.target.value)} required />\n      )}\n      <input type=\"password\" placeholder=\"Mot de passe\" value={motDePasse} onChange={e => setMotDePasse(e.target.value)} required />\n      <button type=\"submit\">Se connecter</button>\n      {error && <div className=\"error\">{error}</div>}\n    </form>\n  );\n}\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}