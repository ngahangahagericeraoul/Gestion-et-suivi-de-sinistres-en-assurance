{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function AjoutRapport(_ref){let{type}=_ref;const[sinistreId,setSinistreId]=useState('');const[rapport,setRapport]=useState('');const[message,setMessage]=useState('');const[gestionnaireEmail,setGestionnaireEmail]=useState('');const token=localStorage.getItem('token');const handleSubmit=async e=>{e.preventDefault();try{const url=type==='expertise'?'http://localhost:5000/api/rapports/expertise':'http://localhost:5000/api/rapports/reparation';const data={sinistre_id:sinistreId,rapport,gestionnaire_email:gestionnaireEmail};if(type==='expertise')data.expert_id=3;// à adapter selon l'utilisateur connecté\nif(type==='reparation')data.reparateur_id=4;// à adapter selon l'utilisateur connecté\nawait axios.post(url,data,{headers:{Authorization:token}});setMessage('Rapport ajouté avec succès');}catch(err){if(err.response&&err.response.data&&err.response.data.message){setMessage(\"Erreur lors de l'ajout du rapport: \".concat(err.response.data.message));}else{setMessage(\"Erreur lors de l'ajout du rapport: \".concat(err.message));}}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Ajouter un rapport de \",type]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"ID du sinistre\",value:sinistreId,onChange:e=>setSinistreId(e.target.value),required:true}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Rapport\",value:rapport,onChange:e=>setRapport(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email du gestionnaire\",value:gestionnaireEmail,onChange:e=>setGestionnaireEmail(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Ajouter\"}),message&&/*#__PURE__*/_jsx(\"div\",{children:message})]});}export default AjoutRapport;","map":{"version":3,"names":["React","useState","axios","jsxs","_jsxs","jsx","_jsx","AjoutRapport","_ref","type","sinistreId","setSinistreId","rapport","setRapport","message","setMessage","gestionnaireEmail","setGestionnaireEmail","token","localStorage","getItem","handleSubmit","e","preventDefault","url","data","sinistre_id","gestionnaire_email","expert_id","reparateur_id","post","headers","Authorization","err","response","concat","onSubmit","children","placeholder","value","onChange","target","required"],"sources":["C:/Users/NGAHA NGAHA/preventis-Gestion-Sinistre/frontend/src/components/Rapport/AjoutRapport.js"],"sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\n\nfunction AjoutRapport({ type }) {\n  const [sinistreId, setSinistreId] = useState('');\n  const [rapport, setRapport] = useState('');\n  const [message, setMessage] = useState('');\n  const [gestionnaireEmail, setGestionnaireEmail] = useState('');\n\n  const token = localStorage.getItem('token');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const url = type === 'expertise'\n        ? 'http://localhost:5000/api/rapports/expertise'\n        : 'http://localhost:5000/api/rapports/reparation';\n      const data = {\n        sinistre_id: sinistreId,\n        rapport,\n        gestionnaire_email: gestionnaireEmail\n      };\n      if (type === 'expertise') data.expert_id = 3; // à adapter selon l'utilisateur connecté\n      if (type === 'reparation') data.reparateur_id = 4; // à adapter selon l'utilisateur connecté\n\n      await axios.post(url, data, { headers: { Authorization: token } });\n      setMessage('Rapport ajouté avec succès');\n    } catch (err) {\n      if (err.response && err.response.data && err.response.data.message) {\n        setMessage(`Erreur lors de l'ajout du rapport: ${err.response.data.message}`);\n      } else {\n        setMessage(`Erreur lors de l'ajout du rapport: ${err.message}`);\n      }\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <h2>Ajouter un rapport de {type}</h2>\n      <input type=\"number\" placeholder=\"ID du sinistre\" value={sinistreId} onChange={e => setSinistreId(e.target.value)} required />\n      <textarea placeholder=\"Rapport\" value={rapport} onChange={e => setRapport(e.target.value)} required />\n      <input type=\"email\" placeholder=\"Email du gestionnaire\" value={gestionnaireEmail} onChange={e => setGestionnaireEmail(e.target.value)} required />\n      <button type=\"submit\">Ajouter</button>\n      {message && <div>{message}</div>}\n    </form>\n  );\n}\nAjoutRapport.propTypes = {\n  type: PropTypes.string.isRequired\n};\n\nexport default AjoutRapport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}